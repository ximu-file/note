# 【Linux】Log分析命令
#技术积累/linux

# 1 . 查看日志之 cat
适用于日志文件较小的时候，如果较大的日志文件就会很占用内存资源，因为cat会将日志一次性全部加载到内存，很吃内存。
`$ cat -n filename`

-n 表示显示日志内容并且带上了行号。

# 2 . 查看日志之 less

适合查找日志比较大的时候，因为这个命令是边查看边加载，所以速度快。
`less -N filename`

-N  表示显示日志内容并且带上了行号。而且还可以在日志中高亮查找。

如果跳转到末尾， less打开之后，输入 `:G` 就会跳转到末尾

跳转到指定行就是`:10000g` 上面就是比如跳转到10000行

==F：表示实时显示日志==

# 3 . 字符统计之 wc

wc命令用来统计指定文件中的字符数、字数、行数，并输出统计结果
```
wc [参数]  [文件名]

-l    统计文件中的行数
-c    统计文件中的字节数
-w    统计文件中的单词数
-L    查看最长行的长度
```

# 4 . 字符串查找 grep
grep命令可以查找文件中符合条件的字符串,比如：
``` 
$grep -o “qq" access.log`

-o参数表示输出查找结果的行
在 access.log 文件中查找 包含字符串 “qq" 的行， 
```

此外grep 还支持正则表达式，一些常用的项如下：

*  -o 只输出匹配的文本行
*  -v 只输出没有匹配的文本行
*  -c 统计文件中包含文本的次数
  grep -c “text” filename   统计filename中包含 text 出现的次数。
*  -n 打印匹配的行号
*  -i  搜索时忽略大小写
*  -l  只打印文件名

# 5 . 排序 sort
```
$ sort  选项  参数(文件)

选项常用是： 
-n  按数值大小排序
-r   相反顺序排序
-k是指定需要排序的栏位，
```
来自: http://man.linuxde.net/sort

# 6 . 消除重复行 uniq
`cat access.log | uniq`

# 7 . 文本数据流处理 awk
### （1）awk脚本基本结构：

`$awk 'BEGIN{ print "start" } pattern{ commands } END{ print "end" }' filename`

一个awk脚本通常由：BEGIN语句块、能够使用模式匹配的通用语句块、END语句块3部分组成，这三个部分是可选的。任意一个部分都可以不出现在脚本中，脚本通常是被单引号或双引号中.

### （2）awk的工作原理：

1）第一步：执行BEGIN{ commands }语句块中的语句；

2）第二步：从文件或标准输入(stdin)读取一行，然后执行pattern{ commands }语句块，它逐行扫描文件，从第一行到最后一行重复这个过程，直到文件全部被读取完毕。 

3）第三步：当读至输入流末尾时，执行END{ commands }语句块。

BEGIN语句块在awk开始从输入流中读取行之前被执行，这是一个可选的语句块，比如变量初始化、打印输出表格的表头等语句通常可以写在BEGIN语句块中。 

END语句块在awk从输入流中读取完所有的行之后即被执行，比如打印所有行的分析结果这类信息汇总都是在END语句块中完成，它也是一个可选语句块。 

pattern语句块中的通用命令是最重要的部分，它也是可选的。如果没有提供pattern语句块，则默认执行{ print }，即打印每一个读取到的行，awk读取的每一行都会执行该语句块。

### （3）示例
`$echo -e "A line 1 \nA line 2" | awk 'BEGIN{ print "Start" } { print } END{ print "End" }’ `

Start 
A line 1 
A line 2 
End

当使用不带参数的print时，它就打印当前行，当print的参数是以逗号进行分隔时，打印时则以空格作为定界符

### （4）awk 内置变量
$n 当前记录的第n个字段，比如n为1表示第一个字段，n为2表示第二个字段。 (字段分隔符默认是空格)

FS 字段分隔符（默认是任何空格）。






